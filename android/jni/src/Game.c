/** updated by emvalac */
/* Game.c generated by valac 0.34.8, the Vala compiler
 * generated from Game.vala, do not modify */


#include <glib.h>
#include <glib-object.h>
#include <stdlib.h>
#include <string.h>
#include <float.h>
#include <math.h>
#include <SDL2/SDL_rect.h>

typedef struct _sdxAbstractGame sdxAbstractGame;
typedef sdxAbstractGame Game;
typedef struct _systemsDisplaySystem systemsDisplaySystem;
typedef struct _entitasWorld entitasWorld;
typedef entitasWorld Factory;
typedef struct _Block1Data Block1Data;
void entitas_world_release (entitasWorld* self);
void entitas_world_free (entitasWorld* self);
entitasWorld* entitas_world_retain (entitasWorld* self);
#define _entitas_world_release0(var) ((var == NULL) ? NULL : (var = (entitas_world_release (var), NULL)))
void sdx_abstract_game_release (sdxAbstractGame* self);
void sdx_abstract_game_free (sdxAbstractGame* self);
sdxAbstractGame* sdx_abstract_game_retain (sdxAbstractGame* self);
#define _sdx_abstract_game_release0(var) ((var == NULL) ? NULL : (var = (sdx_abstract_game_release (var), NULL)))
void systems_display_system_release (systemsDisplaySystem* self);
void systems_display_system_free (systemsDisplaySystem* self);
systemsDisplaySystem* systems_display_system_retain (systemsDisplaySystem* self);
#define _systems_display_system_release0(var) ((var == NULL) ? NULL : (var = (systems_display_system_release (var), NULL)))
typedef struct _entitasSystem entitasSystem;
typedef entitasSystem systemsSpawnSystem;
typedef entitasSystem systemsInputSystem;
typedef entitasSystem systemsPhysicsSystem;
typedef entitasSystem systemsCollisionSystem;
typedef entitasSystem systemsAnimationSystem;
typedef entitasSystem systemsExpireSystem;
typedef entitasSystem systemsRemoveSystem;
typedef entitasSystem systemsScoreSystem;
void entitas_system_release (entitasSystem* self);
void entitas_system_free (entitasSystem* self);
entitasSystem* entitas_system_retain (entitasSystem* self);
#define _entitas_system_release0(var) ((var == NULL) ? NULL : (var = (entitas_system_release (var), NULL)))

#define ENTITAS_TYPE_ENTITY (entitas_entity_get_type ())

#define ENTITAS_TYPE_TRANSFORM (entitas_transform_get_type ())

#define SDX_MATH_TYPE_VECTOR2 (sdx_math_vector2_get_type ())
typedef struct _sdxmathVector2 sdxmathVector2;
typedef struct _sdxgraphicsSprite sdxgraphicsSprite;
typedef struct _entitasTransform entitasTransform;

#define ENTITAS_TYPE_BACKGROUND (entitas_background_get_type ())
typedef struct _entitasBackground entitasBackground;

#define ENTITAS_TYPE_BULLET (entitas_bullet_get_type ())
typedef struct _entitasBullet entitasBullet;

#define ENTITAS_TYPE_ENEMY1 (entitas_enemy1_get_type ())
typedef struct _entitasEnemy1 entitasEnemy1;

#define ENTITAS_TYPE_ENEMY2 (entitas_enemy2_get_type ())
typedef struct _entitasEnemy2 entitasEnemy2;

#define ENTITAS_TYPE_ENEMY3 (entitas_enemy3_get_type ())
typedef struct _entitasEnemy3 entitasEnemy3;

#define ENTITAS_TYPE_EXPIRES (entitas_expires_get_type ())
typedef struct _entitasExpires entitasExpires;

#define ENTITAS_TYPE_HEALTH (entitas_health_get_type ())
typedef struct _entitasHealth entitasHealth;

#define ENTITAS_TYPE_HUD (entitas_hud_get_type ())
typedef struct _entitasHud entitasHud;

#define ENTITAS_TYPE_INDEX (entitas_index_get_type ())
typedef struct _entitasIndex entitasIndex;

#define ENTITAS_TYPE_LAYER (entitas_layer_get_type ())
typedef struct _entitasLayer entitasLayer;

#define ENTITAS_TYPE_SOUND (entitas_sound_get_type ())
typedef struct _sdxaudioSound sdxaudioSound;
typedef struct _entitasSound entitasSound;

#define ENTITAS_TYPE_TEXT (entitas_text_get_type ())
typedef sdxgraphicsSprite sdxgraphicsSpriteTextSprite;
typedef struct _entitasText entitasText;

#define ENTITAS_TYPE_TINT (entitas_tint_get_type ())
typedef struct _entitasTint entitasTint;

#define ENTITAS_TYPE_TWEEN (entitas_tween_get_type ())
typedef struct _entitasTween entitasTween;

#define ENTITAS_TYPE_VELOCITY (entitas_velocity_get_type ())
typedef struct _entitasVelocity entitasVelocity;
typedef struct _entitasEntity entitasEntity;

typedef void (*sdxAbstractGameAbstractUpdate) (void* user_data);
typedef void (*sdxAbstractGameAbstractDraw) (void* user_data);
struct _sdxAbstractGame {
	gint _retainCount;
	gint width;
	gint height;
	sdxAbstractGameAbstractUpdate update;
	gpointer update_target;
	GDestroyNotify update_target_destroy_notify;
	sdxAbstractGameAbstractDraw draw;
	gpointer draw_target;
	GDestroyNotify draw_target_destroy_notify;
};

struct _Block1Data {
	int _ref_count_;
	Game* self;
	Factory* world;
};

struct _sdxmathVector2 {
	gfloat x;
	gfloat y;
};

struct _entitasTransform {
	sdxmathVector2* scale;
	sdxmathVector2* position;
	SDL_Rect* aabb;
	sdxgraphicsSprite* sprite;
};

struct _entitasBackground {
	gboolean active;
};

struct _entitasBullet {
	gboolean active;
};

struct _entitasEnemy1 {
	gboolean active;
};

struct _entitasEnemy2 {
	gboolean active;
};

struct _entitasEnemy3 {
	gboolean active;
};

struct _entitasExpires {
	gfloat value;
};

struct _entitasHealth {
	gfloat current;
	gfloat maximum;
};

struct _entitasHud {
	gboolean active;
};

struct _entitasIndex {
	gint value;
	gint limit;
	gboolean vertical;
};

struct _entitasLayer {
	gint value;
};

struct _entitasSound {
	sdxaudioSound* sound;
};

struct _entitasText {
	gchar* text;
	sdxgraphicsSpriteTextSprite* sprite;
};

struct _entitasTint {
	gint r;
	gint g;
	gint b;
	gint a;
};

struct _entitasTween {
	gfloat min;
	gfloat max;
	gfloat speed;
	gboolean repeat;
	gboolean active;
};

struct _entitasVelocity {
	gfloat x;
	gfloat y;
};

struct _entitasEntity {
	gint id;
	gchar* name;
	gint pool;
	guint64 mask;
	entitasTransform transform;
	entitasBackground* background;
	entitasBullet* bullet;
	entitasEnemy1* enemy1;
	entitasEnemy2* enemy2;
	entitasEnemy3* enemy3;
	entitasExpires* expires;
	entitasHealth* health;
	entitasHud* hud;
	entitasIndex* index;
	entitasLayer* layer;
	entitasSound* sound;
	entitasText* text;
	entitasTint* tint;
	entitasTween* tween;
	entitasVelocity* velocity;
};

typedef entitasEntity* (*entitasEntityRemovedListener) (entitasEntity* e, void* user_data);
struct _systemsDisplaySystem {
	gint _retainCount;
	GList* sprites;
};


extern systemsDisplaySystem* game_display;
systemsDisplaySystem* game_display = NULL;
extern systemsDisplaySystem* systems_display_system_instance;
extern gfloat sdx_delta;

void sdx_abstract_game_free (sdxAbstractGame* self);
void systems_display_system_free (systemsDisplaySystem* self);
Game* game_new (gint w, gint h);
void entitas_world_free (entitasWorld* self);
static Block1Data* block1_data_ref (Block1Data* _data1_);
static void block1_data_unref (void * _userdata_);
sdxAbstractGame* sdx_abstract_game_new (void);
void sdx_setResourceBase (const gchar* path);
void sdx_setSmallFont (const gchar* path, gint size);
void sdx_setDefaultFont (const gchar* path, gint size);
void sdx_setShowFps (gboolean value);
systemsDisplaySystem* systems_display_system_new (void);
Factory* factory_new (void);
void entitas_system_free (entitasSystem* self);
entitasWorld* entitas_world_addSystem (entitasWorld* self, entitasSystem* system);
systemsSpawnSystem* systems_spawn_system_new (Game* game, Factory* world);
systemsInputSystem* systems_input_system_new (Game* game, Factory* world);
systemsPhysicsSystem* systems_physics_system_new (Game* game, Factory* world);
systemsCollisionSystem* systems_collision_system_new (Game* game, Factory* world);
systemsAnimationSystem* systems_animation_system_new (Game* game, Factory* world);
systemsExpireSystem* systems_expire_system_new (Game* game, Factory* world);
systemsRemoveSystem* systems_remove_system_new (Game* game, Factory* world);
systemsScoreSystem* systems_score_system_new (Game* game, Factory* world);
GType entitas_entity_get_type (void) G_GNUC_CONST;
GType entitas_transform_get_type (void) G_GNUC_CONST;
GType sdx_math_vector2_get_type (void) G_GNUC_CONST;
sdxmathVector2* sdx_math_vector2_dup (const sdxmathVector2* self);
void sdx_math_vector2_free (sdxmathVector2* self);
void sdx_graphics_sprite_free (sdxgraphicsSprite* self);
entitasTransform* entitas_transform_dup (const entitasTransform* self);
void entitas_transform_free (entitasTransform* self);
void entitas_transform_copy (const entitasTransform* self, entitasTransform* dest);
void entitas_transform_destroy (entitasTransform* self);
GType entitas_background_get_type (void) G_GNUC_CONST;
entitasBackground* entitas_background_dup (const entitasBackground* self);
void entitas_background_free (entitasBackground* self);
GType entitas_bullet_get_type (void) G_GNUC_CONST;
entitasBullet* entitas_bullet_dup (const entitasBullet* self);
void entitas_bullet_free (entitasBullet* self);
GType entitas_enemy1_get_type (void) G_GNUC_CONST;
entitasEnemy1* entitas_enemy1_dup (const entitasEnemy1* self);
void entitas_enemy1_free (entitasEnemy1* self);
GType entitas_enemy2_get_type (void) G_GNUC_CONST;
entitasEnemy2* entitas_enemy2_dup (const entitasEnemy2* self);
void entitas_enemy2_free (entitasEnemy2* self);
GType entitas_enemy3_get_type (void) G_GNUC_CONST;
entitasEnemy3* entitas_enemy3_dup (const entitasEnemy3* self);
void entitas_enemy3_free (entitasEnemy3* self);
GType entitas_expires_get_type (void) G_GNUC_CONST;
entitasExpires* entitas_expires_dup (const entitasExpires* self);
void entitas_expires_free (entitasExpires* self);
GType entitas_health_get_type (void) G_GNUC_CONST;
entitasHealth* entitas_health_dup (const entitasHealth* self);
void entitas_health_free (entitasHealth* self);
GType entitas_hud_get_type (void) G_GNUC_CONST;
entitasHud* entitas_hud_dup (const entitasHud* self);
void entitas_hud_free (entitasHud* self);
GType entitas_index_get_type (void) G_GNUC_CONST;
entitasIndex* entitas_index_dup (const entitasIndex* self);
void entitas_index_free (entitasIndex* self);
GType entitas_layer_get_type (void) G_GNUC_CONST;
entitasLayer* entitas_layer_dup (const entitasLayer* self);
void entitas_layer_free (entitasLayer* self);
GType entitas_sound_get_type (void) G_GNUC_CONST;
void sdx_audio_sound_free (sdxaudioSound* self);
entitasSound* entitas_sound_dup (const entitasSound* self);
void entitas_sound_free (entitasSound* self);
void entitas_sound_copy (const entitasSound* self, entitasSound* dest);
void entitas_sound_destroy (entitasSound* self);
GType entitas_text_get_type (void) G_GNUC_CONST;
entitasText* entitas_text_dup (const entitasText* self);
void entitas_text_free (entitasText* self);
void entitas_text_copy (const entitasText* self, entitasText* dest);
void entitas_text_destroy (entitasText* self);
GType entitas_tint_get_type (void) G_GNUC_CONST;
entitasTint* entitas_tint_dup (const entitasTint* self);
void entitas_tint_free (entitasTint* self);
GType entitas_tween_get_type (void) G_GNUC_CONST;
entitasTween* entitas_tween_dup (const entitasTween* self);
void entitas_tween_free (entitasTween* self);
GType entitas_velocity_get_type (void) G_GNUC_CONST;
entitasVelocity* entitas_velocity_dup (const entitasVelocity* self);
void entitas_velocity_free (entitasVelocity* self);
entitasEntity* entitas_entity_dup (const entitasEntity* self);
void entitas_entity_free (entitasEntity* self);
void entitas_entity_copy (const entitasEntity* self, entitasEntity* dest);
void entitas_entity_destroy (entitasEntity* self);
void entitas_world_setEntityRemovedListener (entitasWorld* self, entitasEntityRemovedListener removed, void* removed_target);
static entitasEntity* __lambda17_ (Game* self, entitasEntity* it);
void systems_display_system_remove (systemsDisplaySystem* self, entitasEntity* e);
static entitasEntity* ___lambda17__entitas_entity_removed_listener (entitasEntity* e, gpointer self);
void entitas_world_initialize (entitasWorld* self);
entitasEntity* factory_createBackground (Factory* self);
static void __lambda18_ (Block1Data* _data1_);
void entitas_world_execute (entitasWorld* self, gfloat delta);
static void ___lambda18__sdx_abstract_game_abstract_update (gpointer self);
static void __lambda19_ (Game* self);
void sdx_begin (void);
gboolean entitas_entity_isActive (entitasEntity *self);
gboolean systems_display_system_draw (systemsDisplaySystem* self, entitasEntity* e, entitasTransform* t);
void sdx_end (void);
static void ___lambda19__sdx_abstract_game_abstract_draw (gpointer self);


static Block1Data* block1_data_ref (Block1Data* _data1_) {
	g_atomic_int_inc (&_data1_->_ref_count_);
	return _data1_;
}


static void block1_data_unref (void * _userdata_) {
	Block1Data* _data1_;
	_data1_ = (Block1Data*) _userdata_;
	if (g_atomic_int_dec_and_test (&_data1_->_ref_count_)) {
		Game* self;
		self = _data1_->self;
		_entitas_world_release0 (_data1_->world);
		_sdx_abstract_game_release0 (self);
		g_slice_free (Block1Data, _data1_);
	}
}


static entitasEntity* __lambda17_ (Game* self, entitasEntity* it) {
	entitasEntity* result = NULL;
	systemsDisplaySystem* _tmp0_ = NULL;
	entitasEntity* _tmp1_ = NULL;
	entitasEntity* _tmp2_ = NULL;
	_tmp0_ = systems_display_system_instance;
	_tmp1_ = it;
	systems_display_system_remove (_tmp0_, _tmp1_);
	_tmp2_ = it;
	result = _tmp2_;
	return result;
}


static entitasEntity* ___lambda17__entitas_entity_removed_listener (entitasEntity* e, gpointer self) {
	entitasEntity* result;
	result = __lambda17_ ((Game*) self, e);
	return result;
}


static void __lambda18_ (Block1Data* _data1_) {
	Game* self;
	gfloat _tmp0_ = 0.0F;
	self = _data1_->self;
	_tmp0_ = sdx_delta;
	entitas_world_execute ((entitasWorld*) _data1_->world, _tmp0_);
}


static void ___lambda18__sdx_abstract_game_abstract_update (gpointer self) {
	__lambda18_ (self);
}


static void __lambda19_ (Game* self) {
	systemsDisplaySystem* _tmp0_ = NULL;
	GList* _tmp1_ = NULL;
	sdx_begin ();
	_tmp0_ = game_display;
	_tmp1_ = _tmp0_->sprites;
	{
		GList* entity_collection = NULL;
		GList* entity_it = NULL;
		entity_collection = _tmp1_;
		for (entity_it = entity_collection; entity_it != NULL; entity_it = entity_it->next) {
			entitasEntity* entity = NULL;
			entity = entity_it->data;
			{
				gboolean _tmp2_ = FALSE;
				_tmp2_ = entitas_entity_isActive (entity);
				if (_tmp2_) {
					systemsDisplaySystem* _tmp3_ = NULL;
					entitasEntity* _tmp4_ = NULL;
					_tmp3_ = game_display;
					_tmp4_ = entity;
					systems_display_system_draw (_tmp3_, _tmp4_, &(*entity).transform);
				}
			}
		}
	}
	sdx_end ();
}


static void ___lambda19__sdx_abstract_game_abstract_draw (gpointer self) {
	__lambda19_ ((Game*) self);
}


Game* game_new (gint w, gint h) {
	Game* self;
	Block1Data* _data1_;
	gint _tmp0_ = 0;
	gint _tmp1_ = 0;
	systemsDisplaySystem* _tmp2_ = NULL;
	Factory* _tmp3_ = NULL;
	systemsSpawnSystem* _tmp4_ = NULL;
	systemsSpawnSystem* _tmp5_ = NULL;
	entitasWorld* _tmp6_ = NULL;
	entitasWorld* _tmp7_ = NULL;
	systemsInputSystem* _tmp8_ = NULL;
	systemsInputSystem* _tmp9_ = NULL;
	entitasWorld* _tmp10_ = NULL;
	entitasWorld* _tmp11_ = NULL;
	systemsPhysicsSystem* _tmp12_ = NULL;
	systemsPhysicsSystem* _tmp13_ = NULL;
	entitasWorld* _tmp14_ = NULL;
	entitasWorld* _tmp15_ = NULL;
	systemsCollisionSystem* _tmp16_ = NULL;
	systemsCollisionSystem* _tmp17_ = NULL;
	entitasWorld* _tmp18_ = NULL;
	entitasWorld* _tmp19_ = NULL;
	systemsAnimationSystem* _tmp20_ = NULL;
	systemsAnimationSystem* _tmp21_ = NULL;
	entitasWorld* _tmp22_ = NULL;
	entitasWorld* _tmp23_ = NULL;
	systemsExpireSystem* _tmp24_ = NULL;
	systemsExpireSystem* _tmp25_ = NULL;
	entitasWorld* _tmp26_ = NULL;
	entitasWorld* _tmp27_ = NULL;
	systemsRemoveSystem* _tmp28_ = NULL;
	systemsRemoveSystem* _tmp29_ = NULL;
	entitasWorld* _tmp30_ = NULL;
	entitasWorld* _tmp31_ = NULL;
	systemsScoreSystem* _tmp32_ = NULL;
	systemsScoreSystem* _tmp33_ = NULL;
	entitasWorld* _tmp34_ = NULL;
	entitasWorld* _tmp35_ = NULL;
	_data1_ = g_slice_new0 (Block1Data);
	_data1_->_ref_count_ = 1;
	self = (Game*) sdx_abstract_game_new ();
	_data1_->self = sdx_abstract_game_retain (self);
	_tmp0_ = w;
	((sdxAbstractGame*) self)->width = _tmp0_;
	_tmp1_ = h;
	((sdxAbstractGame*) self)->height = _tmp1_;
	sdx_setResourceBase ("/darkoverlordofdata/shmupwarz");
	sdx_setSmallFont ("assets/fonts/OpenDyslexic-Bold.otf", 16);
	sdx_setDefaultFont ("assets/fonts/OpenDyslexic-Bold.otf", 24);
	sdx_setShowFps (TRUE);
	_tmp2_ = systems_display_system_new ();
	_systems_display_system_release0 (game_display);
	game_display = _tmp2_;
	_tmp3_ = factory_new ();
	_data1_->world = _tmp3_;
	_tmp4_ = systems_spawn_system_new (self, _data1_->world);
	_tmp5_ = _tmp4_;
	_tmp6_ = entitas_world_addSystem ((entitasWorld*) _data1_->world, (entitasSystem*) _tmp5_);
	_tmp7_ = _tmp6_;
	_tmp8_ = systems_input_system_new (self, _data1_->world);
	_tmp9_ = _tmp8_;
	_tmp10_ = entitas_world_addSystem (_tmp7_, (entitasSystem*) _tmp9_);
	_tmp11_ = _tmp10_;
	_tmp12_ = systems_physics_system_new (self, _data1_->world);
	_tmp13_ = _tmp12_;
	_tmp14_ = entitas_world_addSystem (_tmp11_, (entitasSystem*) _tmp13_);
	_tmp15_ = _tmp14_;
	_tmp16_ = systems_collision_system_new (self, _data1_->world);
	_tmp17_ = _tmp16_;
	_tmp18_ = entitas_world_addSystem (_tmp15_, (entitasSystem*) _tmp17_);
	_tmp19_ = _tmp18_;
	_tmp20_ = systems_animation_system_new (self, _data1_->world);
	_tmp21_ = _tmp20_;
	_tmp22_ = entitas_world_addSystem (_tmp19_, (entitasSystem*) _tmp21_);
	_tmp23_ = _tmp22_;
	_tmp24_ = systems_expire_system_new (self, _data1_->world);
	_tmp25_ = _tmp24_;
	_tmp26_ = entitas_world_addSystem (_tmp23_, (entitasSystem*) _tmp25_);
	_tmp27_ = _tmp26_;
	_tmp28_ = systems_remove_system_new (self, _data1_->world);
	_tmp29_ = _tmp28_;
	_tmp30_ = entitas_world_addSystem (_tmp27_, (entitasSystem*) _tmp29_);
	_tmp31_ = _tmp30_;
	_tmp32_ = systems_score_system_new (self, _data1_->world);
	_tmp33_ = _tmp32_;
	_tmp34_ = entitas_world_addSystem (_tmp31_, (entitasSystem*) _tmp33_);
	_tmp35_ = _tmp34_;
	_entitas_world_release0 (_tmp35_);
	_entitas_system_release0 (_tmp33_);
	_entitas_world_release0 (_tmp31_);
	_entitas_system_release0 (_tmp29_);
	_entitas_world_release0 (_tmp27_);
	_entitas_system_release0 (_tmp25_);
	_entitas_world_release0 (_tmp23_);
	_entitas_system_release0 (_tmp21_);
	_entitas_world_release0 (_tmp19_);
	_entitas_system_release0 (_tmp17_);
	_entitas_world_release0 (_tmp15_);
	_entitas_system_release0 (_tmp13_);
	_entitas_world_release0 (_tmp11_);
	_entitas_system_release0 (_tmp9_);
	_entitas_world_release0 (_tmp7_);
	_entitas_system_release0 (_tmp5_);
	entitas_world_setEntityRemovedListener ((entitasWorld*) _data1_->world, ___lambda17__entitas_entity_removed_listener, self);
	entitas_world_initialize ((entitasWorld*) _data1_->world);
	factory_createBackground (_data1_->world);
	(((sdxAbstractGame*) self)->update_target_destroy_notify == NULL) ? NULL : (((sdxAbstractGame*) self)->update_target_destroy_notify (((sdxAbstractGame*) self)->update_target), NULL);
	((sdxAbstractGame*) self)->update = NULL;
	((sdxAbstractGame*) self)->update_target = NULL;
	((sdxAbstractGame*) self)->update_target_destroy_notify = NULL;
	((sdxAbstractGame*) self)->update = ___lambda18__sdx_abstract_game_abstract_update;
	((sdxAbstractGame*) self)->update_target = block1_data_ref (_data1_);
	((sdxAbstractGame*) self)->update_target_destroy_notify = block1_data_unref;
	(((sdxAbstractGame*) self)->draw_target_destroy_notify == NULL) ? NULL : (((sdxAbstractGame*) self)->draw_target_destroy_notify (((sdxAbstractGame*) self)->draw_target), NULL);
	((sdxAbstractGame*) self)->draw = NULL;
	((sdxAbstractGame*) self)->draw_target = NULL;
	((sdxAbstractGame*) self)->draw_target_destroy_notify = NULL;
	((sdxAbstractGame*) self)->draw = ___lambda19__sdx_abstract_game_abstract_draw;
	((sdxAbstractGame*) self)->draw_target = sdx_abstract_game_retain (self);
	((sdxAbstractGame*) self)->draw_target_destroy_notify = sdx_abstract_game_release;
	block1_data_unref (_data1_);
	_data1_ = NULL;
	return self;
}



