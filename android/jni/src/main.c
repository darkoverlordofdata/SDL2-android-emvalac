/* main.c generated by valac 0.34.8, the Vala compiler
 * generated from main.vala, do not modify */


#include <glib.h>
#include <glib-object.h>
#include <SDL_render.h>
#include <stdlib.h>
#include <string.h>
#include <SDL_surface.h>
#include <SDL.h>
#include <SDL_video.h>
#include <SDL_rect.h>
#include <SDL_events.h>

typedef struct _Sprite Sprite;
#define _SDL_DestroyTexture0(var) ((var == NULL) ? NULL : (var = (SDL_DestroyTexture (var), NULL)))
#define _SDL_FreeSurface0(var) ((var == NULL) ? NULL : (var = (SDL_FreeSurface (var), NULL)))
#define _SDL_DestroyWindow0(var) ((var == NULL) ? NULL : (var = (SDL_DestroyWindow (var), NULL)))
#define _SDL_DestroyRenderer0(var) ((var == NULL) ? NULL : (var = (SDL_DestroyRenderer (var), NULL)))
void sprite_release (Sprite* self);
void sprite_free (Sprite* self);
Sprite* sprite_retain (Sprite* self);
#define _sprite_release0(var) ((var == NULL) ? NULL : (var = (sprite_release (var), NULL)))

struct _Sprite {
	gint _retainCount;
	SDL_Texture* texture;
	guint16 w;
	guint16 h;
};



void sprite_free (Sprite* self);
static void sprite_instance_init (Sprite * self);
Sprite* sprite_retain (Sprite* self);
void sprite_release (Sprite* self);
void sprite_free (Sprite* self);
Sprite* sprite_new (const gchar* file, SDL_Renderer* renderer);
void draw (SDL_Window* window, SDL_Renderer* renderer, Sprite* sprite);
gint _vala_main (const gchar* args, int args_length1);


Sprite* sprite_retain (Sprite* self) {
	Sprite* result = NULL;
	g_return_val_if_fail (self != NULL, NULL);
	g_atomic_int_add ((volatile gint *) (&self->_retainCount), 1);
	result = self;
	return result;
}


void sprite_release (Sprite* self) {
	gboolean _tmp0_ = FALSE;
	g_return_if_fail (self != NULL);
	_tmp0_ = g_atomic_int_dec_and_test ((volatile gint *) (&self->_retainCount));
	if (_tmp0_) {
		sprite_free (self);
	}
}


Sprite* sprite_new (const gchar* file, SDL_Renderer* renderer) {
	Sprite* self;
	SDL_Surface* temp = NULL;
	const gchar* _tmp0_ = NULL;
	SDL_Surface* _tmp1_ = NULL;
	SDL_Surface* _tmp2_ = NULL;
	SDL_Surface* _tmp5_ = NULL;
	gint _tmp6_ = 0;
	SDL_Surface* _tmp7_ = NULL;
	gint _tmp8_ = 0;
	SDL_Renderer* _tmp9_ = NULL;
	SDL_Surface* _tmp10_ = NULL;
	SDL_Texture* _tmp11_ = NULL;
	SDL_Texture* _tmp12_ = NULL;
	g_return_val_if_fail (file != NULL, NULL);
	g_return_val_if_fail (renderer != NULL, NULL);
	self = g_slice_new0 (Sprite);
	sprite_instance_init (self);
	_tmp0_ = file;
	_tmp1_ = SDL_LoadBMP (_tmp0_);
	temp = _tmp1_;
	_tmp2_ = temp;
	if (_tmp2_ == NULL) {
		const gchar* _tmp3_ = NULL;
		const gchar* _tmp4_ = NULL;
		_tmp3_ = file;
		_tmp4_ = SDL_GetError ();
		g_print ("Couldn't load %s: %s\n", _tmp3_, _tmp4_);
	}
	_tmp5_ = temp;
	_tmp6_ = _tmp5_->w;
	self->w = (guint16) _tmp6_;
	_tmp7_ = temp;
	_tmp8_ = _tmp7_->h;
	self->h = (guint16) _tmp8_;
	_tmp9_ = renderer;
	_tmp10_ = temp;
	_tmp11_ = SDL_CreateTextureFromSurface (_tmp9_, _tmp10_);
	_SDL_DestroyTexture0 (self->texture);
	self->texture = _tmp11_;
	_tmp12_ = self->texture;
	if (_tmp12_ == NULL) {
		const gchar* _tmp13_ = NULL;
		_tmp13_ = SDL_GetError ();
		g_print ("Couldn't create texture: %s\n", _tmp13_);
	}
	_SDL_FreeSurface0 (temp);
	return self;
}


static void sprite_instance_init (Sprite * self) {
	self->_retainCount = 1;
}


void sprite_free (Sprite* self) {
	_SDL_DestroyTexture0 (self->texture);
	g_slice_free (Sprite, self);
}


void draw (SDL_Window* window, SDL_Renderer* renderer, Sprite* sprite) {
	gint w = 0;
	gint h = 0;
	SDL_Window* _tmp0_ = NULL;
	gint _tmp1_ = 0;
	gint _tmp2_ = 0;
	SDL_Rect destRect = {0};
	Sprite* _tmp3_ = NULL;
	guint16 _tmp4_ = 0U;
	Sprite* _tmp5_ = NULL;
	guint16 _tmp6_ = 0U;
	Sprite* _tmp7_ = NULL;
	guint16 _tmp8_ = 0U;
	Sprite* _tmp9_ = NULL;
	guint16 _tmp10_ = 0U;
	SDL_Rect _tmp11_ = {0};
	SDL_Renderer* _tmp12_ = NULL;
	Sprite* _tmp13_ = NULL;
	SDL_Texture* _tmp14_ = NULL;
	SDL_Rect _tmp15_ = {0};
	g_return_if_fail (window != NULL);
	g_return_if_fail (renderer != NULL);
	g_return_if_fail (sprite != NULL);
	_tmp0_ = window;
	SDL_GetWindowSize (_tmp0_, &_tmp1_, &_tmp2_);
	w = _tmp1_;
	h = _tmp2_;
	_tmp3_ = sprite;
	_tmp4_ = _tmp3_->w;
	_tmp5_ = sprite;
	_tmp6_ = _tmp5_->h;
	_tmp7_ = sprite;
	_tmp8_ = _tmp7_->w;
	_tmp9_ = sprite;
	_tmp10_ = _tmp9_->h;
	_tmp11_.x = (w / 2) - (_tmp4_ / 2);
	_tmp11_.y = (h / 2) - (_tmp6_ / 2);
	_tmp11_.w = (guint) _tmp8_;
	_tmp11_.h = (guint) _tmp10_;
	destRect = _tmp11_;
	_tmp12_ = renderer;
	_tmp13_ = sprite;
	_tmp14_ = _tmp13_->texture;
	_tmp15_ = destRect;
	SDL_RenderCopy (_tmp12_, _tmp14_, NULL, &_tmp15_);
}


gint _vala_main (const gchar* args, int args_length1) {
	gint result = 0;
	SDL_Window* window = NULL;
	SDL_Renderer* renderer = NULL;
	SDL_Window* _tmp0_ = NULL;
	SDL_Renderer* _tmp1_ = NULL;
	gint _tmp2_ = 0;
	Sprite* sprite = NULL;
	SDL_Renderer* _tmp3_ = NULL;
	Sprite* _tmp4_ = NULL;
	Sprite* _tmp5_ = NULL;
	SDL_Texture* _tmp6_ = NULL;
	gboolean done = FALSE;
	SDL_Event event = {0};
	_tmp2_ = SDL_CreateWindowAndRenderer (0, 0, (guint32) 0, &_tmp0_, &_tmp1_);
	_SDL_DestroyWindow0 (window);
	window = _tmp0_;
	_SDL_DestroyRenderer0 (renderer);
	renderer = _tmp1_;
	if (_tmp2_ < 0) {
		result = 2;
		_SDL_DestroyRenderer0 (renderer);
		_SDL_DestroyWindow0 (window);
		return result;
	}
	_tmp3_ = renderer;
	_tmp4_ = sprite_new ("sample.bmp", _tmp3_);
	sprite = _tmp4_;
	_tmp5_ = sprite;
	_tmp6_ = _tmp5_->texture;
	if (_tmp6_ == NULL) {
		result = 2;
		_sprite_release0 (sprite);
		_SDL_DestroyRenderer0 (renderer);
		_SDL_DestroyWindow0 (window);
		return result;
	}
	done = FALSE;
	while (TRUE) {
		gboolean _tmp7_ = FALSE;
		SDL_Event _tmp8_ = {0};
		SDL_Renderer* _tmp20_ = NULL;
		SDL_Renderer* _tmp21_ = NULL;
		SDL_Window* _tmp22_ = NULL;
		SDL_Renderer* _tmp23_ = NULL;
		Sprite* _tmp24_ = NULL;
		SDL_Renderer* _tmp25_ = NULL;
		_tmp7_ = done;
		if (!(!_tmp7_)) {
			break;
		}
		SDL_WaitEvent (&_tmp8_);
		 (event);
		event = _tmp8_;
		{
			gboolean _tmp9_ = FALSE;
			_tmp9_ = TRUE;
			while (TRUE) {
				gboolean _tmp12_ = FALSE;
				gboolean _tmp13_ = FALSE;
				SDL_Event _tmp14_ = {0};
				SDL_EventType _tmp15_ = 0;
				if (!_tmp9_) {
					SDL_Event _tmp10_ = {0};
					gint _tmp11_ = 0;
					_tmp11_ = SDL_PollEvent (&_tmp10_);
					 (event);
					event = _tmp10_;
					if (!(_tmp11_ > 0)) {
						break;
					}
				}
				_tmp9_ = FALSE;
				_tmp14_ = event;
				_tmp15_ = _tmp14_.type;
				if (_tmp15_ == SDL_QUIT) {
					_tmp13_ = TRUE;
				} else {
					SDL_Event _tmp16_ = {0};
					SDL_EventType _tmp17_ = 0;
					_tmp16_ = event;
					_tmp17_ = _tmp16_.type;
					_tmp13_ = _tmp17_ == SDL_KEYDOWN;
				}
				if (_tmp13_) {
					_tmp12_ = TRUE;
				} else {
					SDL_Event _tmp18_ = {0};
					SDL_EventType _tmp19_ = 0;
					_tmp18_ = event;
					_tmp19_ = _tmp18_.type;
					_tmp12_ = _tmp19_ == SDL_FINGERDOWN;
				}
				if (_tmp12_) {
					done = TRUE;
				}
			}
		}
		_tmp20_ = renderer;
		SDL_SetRenderDrawColor (_tmp20_, (guint8) 0x00, (guint8) 0x00, (guint8) 0x00, (guint8) 0xFF);
		_tmp21_ = renderer;
		SDL_RenderClear (_tmp21_);
		_tmp22_ = window;
		_tmp23_ = renderer;
		_tmp24_ = sprite;
		draw (_tmp22_, _tmp23_, _tmp24_);
		_tmp25_ = renderer;
		SDL_RenderPresent (_tmp25_);
	}
	result = 0;
	 (event);
	_sprite_release0 (sprite);
	_SDL_DestroyRenderer0 (renderer);
	_SDL_DestroyWindow0 (window);
	return result;
}


int main (int argc, char ** argv) {
#if !GLIB_CHECK_VERSION (2,35,0)
	g_type_init ();
#endif
	return _vala_main (argv, argc);
}



